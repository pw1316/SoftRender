# 区间扫描线Z缓冲

## 环境

| 环境 |  |
|--|--|
| OS | Windows10 pro 1709 |
| IDE | Visual Studio 2017 Community |
| 工具集 | v141 |
| WindowsSDK版本 | 10.0.15063.0 |

## 编译链接选项

| 选项 |  |
|--|--|
| 平台 | x64 |
| 配置 | Release |
| 优化 | 速度最大(O2) |
| 指令增强 | AVX2 |
| 浮点模型 | 快速(fast) |

## 绘制框架

利用Win32API管理一块绘制屏幕大小的内存区域作为帧缓存，绘制结束后将这块内存区域复制到窗口对应的句柄内显示

## 绘制流水

读入的obj文件包含了所有顶点的坐标，以及所有面片的顶点索引，并支持obj格式的面片分组

1. 数据结构建立
    1. 对每一个三角形面片，计算相机空间内的坐标，与屏幕上的坐标
    1. 将该三角形加入多边形表，根据光照计算颜色
    1. 对多边形的每一条边，加入边表
1. 逐扫描线操作，从下至上扫描
    1. 把该行的边加入活化边表
    1. 活化边表排序
    1. 对每个扫描线区间，找到离视点最近的多边形，若没有多边形则返回-1
    1. 更新活化多边形表，区间右侧边所在多边形，如果已有in标记，则改为out，若没有则设置in标记
    1. 更新活化边表，删除扫描完成的边

## 使用

